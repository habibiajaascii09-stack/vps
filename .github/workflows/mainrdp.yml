name: Setup RDP with Tailscale

on:
  workflow_dispatch:

jobs:
  setup-rdp:
    runs-on: ubuntu-latest

    steps:
    - name: Install Tailscale
      run: |
        curl -fsSL https://tailscale.com/install.sh | sh
        sudo tailscale login --auth-key ${{ secrets.TAILSCALE_AUTH_KEY }}
        sudo tailscale up
        sleep 5

    - name: Setup RDP
      run: |
        sudo apt update
        sudo apt install -y xrdp xfce4 firefox
        echo "ubuntu:password123" | sudo chpasswd
        sudo systemctl start xrdp

    - name: Log RDP Details
      run: |
        RDP_IP=$(tailscale ip -4)
        echo "RDP IP: $RDP_IP"
        echo "User: ubuntu"
        echo "Password: password123"
        echo "Connect to $RDP_IP:3389, open Firefox for YouTube."
